version: '3.8'

services:
  router1:
    build:
      context: ./router
      dockerfile: Dockerfile
    environment:
      - my_name=router1
      - my_ip=172.18.1.3
      - router_links=router2,router8
      - router2_ip=172.18.2.3
      - router8_ip=172.18.8.3
      
    networks:
      subnet_1:
        ipv4_address: 172.18.1.3
      subnet_2:
        ipv4_address: 172.18.2.4
      subnet_8:
        ipv4_address: 172.18.8.5
      
    cap_add:
      - NET_ADMIN
    volumes:
      - ./logs:/app/logs

  router2:
    build:
      context: ./router
      dockerfile: Dockerfile
    environment:
      - my_name=router2
      - my_ip=172.18.2.3
      - router_links=router1,router3
      - router1_ip=172.18.1.3
      - router3_ip=172.18.3.3
    networks:
      subnet_2:
        ipv4_address: 172.18.2.3
      subnet_1:
        ipv4_address: 172.18.1.2
      subnet_3:
        ipv4_address: 172.18.3.4
    cap_add:
      - NET_ADMIN
    volumes:
      - ./logs:/app/logs

  router3:
    build:
      context: ./router
      dockerfile: Dockerfile
    environment:
      - my_name=router3
      - my_ip=172.18.3.3
      - router_links=router2,router4
      - router2_ip=172.18.2.3
      - router4_ip=172.18.4.3
      
      
    networks:
      subnet_3:
        ipv4_address: 172.18.3.3
      subnet_2:
        ipv4_address: 172.18.2.2
      subnet_4:
        ipv4_address: 172.18.4.4
      
      
      
    cap_add:
      - NET_ADMIN
    volumes:
      - ./logs:/app/logs
  
  router4:
    build:
      context: ./router
      dockerfile: Dockerfile
    environment:
      - my_name=router4
      - my_ip=172.18.4.3
      - router_links=router3,router5
      - router3_ip=172.18.3.3
      - router5_ip=172.18.5.3
      
    networks:
      subnet_4:
        ipv4_address: 172.18.4.3
      subnet_3:
        ipv4_address: 172.18.3.2
      subnet_5:
        ipv4_address: 172.18.5.4
      
    cap_add:
      - NET_ADMIN
    volumes:
      - ./logs:/app/logs
  
  router5:
    build:
      context: ./router
      dockerfile: Dockerfile
    environment:
      - my_name=router5
      - my_ip=172.18.5.3
      - router_links=router4,router6
      - router4_ip=172.18.4.3
      - router6_ip=172.18.6.3
      
    networks:
      subnet_5:
        ipv4_address: 172.18.5.3
      subnet_4:
        ipv4_address: 172.18.4.2
      subnet_6:
        ipv4_address: 172.18.6.4
    cap_add:
      - NET_ADMIN
    volumes:
      - ./logs:/app/logs
  
  router6:
    build:
      context: ./router
      dockerfile: Dockerfile
    environment:
      - my_name=router6
      - my_ip=172.18.6.3
      - router_links=router5,router7
      - router5_ip=172.18.5.3
      - router7_ip=172.18.7.3
    networks:
      subnet_6:
        ipv4_address: 172.18.6.3
      subnet_5:
        ipv4_address: 172.18.5.2
      subnet_7:
        ipv4_address: 172.18.7.4
    cap_add:
      - NET_ADMIN
    volumes:
      - ./logs:/app/logs

  router7:
    build:
      context: ./router
      dockerfile: Dockerfile
    environment:
      - my_name=router7
      - my_ip=172.18.7.3
      - router_links=router6,router8
      - router6_ip=172.18.6.3
      - router8_ip=172.18.8.3
    networks:
      subnet_7:
        ipv4_address: 172.18.7.3
      subnet_6:
        ipv4_address: 172.18.6.2
      subnet_8:
        ipv4_address: 172.18.8.4
    cap_add:
      - NET_ADMIN
    volumes:
      - ./logs:/app/logs

  router8:
    build:
      context: ./router
      dockerfile: Dockerfile
    environment:
      - my_name=router8
      - my_ip=172.18.8.3
      - router_links=router7,router1
      - router7_ip=172.18.7.3
      - router1_ip=172.18.1.3
    networks:
      subnet_8:
        ipv4_address: 172.18.8.3
      subnet_7:
        ipv4_address: 172.18.7.2
      subnet_1:
        ipv4_address: 172.18.1.4
    cap_add:
      - NET_ADMIN
    volumes:
      - ./logs:/app/logs


  
  
  
  
  

  host1a:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host1a
      - my_ip=172.18.1.10
      - gateway_ip=172.18.1.3
    networks:
      subnet_1:
        ipv4_address: 172.18.1.10
    depends_on:
      - router1
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.1.3' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.10' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host1b:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host1b
      - my_ip=172.18.1.11
      - gateway_ip=172.18.1.3
    networks:
      subnet_1:
        ipv4_address: 172.18.1.11
    depends_on:
      - router1
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.1.3' 'ping 172.18.1.10' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.10' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host2a:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host2a
      - my_ip=172.18.2.10
      - gateway_ip=172.18.2.3
    networks:
      subnet_2:
        ipv4_address: 172.18.2.10
    depends_on:
      - router2
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.2.3' 'ping 172.18.2.11' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.10' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host2b:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host2b
      - my_ip=172.18.2.11
      - gateway_ip=172.18.2.3
    networks:
      subnet_2:
        ipv4_address: 172.18.2.11
    depends_on:
      - router2
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.2.3' 'ping 172.18.2.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.10' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host3a:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host3a
      - my_ip=172.18.3.10
      - gateway_ip=172.18.3.3
    networks:
      subnet_3:
        ipv4_address: 172.18.3.10
    depends_on:
      - router3
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.3.3' 'ping 172.18.3.11' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.10' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host3b:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host3b
      - my_ip=172.18.3.11
      - gateway_ip=172.18.1.3
    networks:
      subnet_3:
        ipv4_address: 172.18.3.11
    depends_on:
      - router3
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.3.3' 'ping 172.18.3.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.10' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN
  
  host4a:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host4a
      - my_ip=172.18.4.10
      - gateway_ip=172.18.4.3
    networks:
      subnet_4:
        ipv4_address: 172.18.4.10
    depends_on:
      - router4
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.4.3' 'ping 172.18.4.11' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.5.10' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN
  
  host4b:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host4b
      - my_ip=172.18.4.11
      - gateway_ip=172.18.4.3
    networks:
      subnet_4:
        ipv4_address: 172.18.4.11
    depends_on:
      - router4
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.4.3' 'ping 172.18.4.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.5.10' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN
  
  host5a:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host5a
      - my_ip=172.18.5.10
      - gateway_ip=172.18.5.3
    networks:
      subnet_5:
        ipv4_address: 172.18.5.10
    depends_on:
      - router5
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.5.3' 'ping 172.18.5.11' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN
  
  host5b:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host5b
      - my_ip=172.18.5.11
      - gateway_ip=172.18.5.3
    networks:
      subnet_5:
        ipv4_address: 172.18.5.11
    depends_on:
      - router5
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.5.3' 'ping 172.18.5.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN
  
  host6a:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host6a
      - my_ip=172.18.6.10
      - gateway_ip=172.18.6.3
    networks:
      subnet_6:
        ipv4_address: 172.18.6.10
    depends_on:
      - router6
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.6.3' 'ping 172.18.6.11' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11' 'ping 172.18.5.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.11' "]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host6b:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host6b
      - my_ip=172.18.6.11
      - gateway_ip=172.18.6.3
    networks:
      subnet_6:
        ipv4_address: 172.18.6.11
    depends_on:
      - router6
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.6.3' 'ping 172.18.6.10' 'ping 172.18.7.10' 'ping 172.18.7.11' 'ping 172.18.8.10' 'ping 172.18.8.11' 'ping 172.18.5.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host7a:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host7a
      - my_ip=172.18.7.10
      - gateway_ip=172.18.7.3
    networks:
      subnet_7:
        ipv4_address: 172.18.7.10
    depends_on:
      - router7
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.7.3' 'ping 172.18.7.11' 'ping 172.18.5.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.8.10' 'ping 172.18.8.11' "]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host7b:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host7b
      - my_ip=172.18.7.11
      - gateway_ip=172.18.7.3
    networks:
      subnet_7:
        ipv4_address: 172.18.7.11
    depends_on:
      - router7
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.7.3' 'ping 172.18.7.10' 'ping 172.18.5.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.11'  'ping 172.18.6.10' 'ping 172.18.6.11' 'ping 172.18.8.10' 'ping 172.18.8.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host8a:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host8a
      - my_ip=172.18.8.10
      - gateway_ip=172.18.8.3
    networks:
      subnet_8:
        ipv4_address: 172.18.8.10
    depends_on:
      - router8
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.8.3' 'ping 172.18.8.11' 'ping 172.18.7.11' 'ping 172.18.7.10' 'ping 172.18.5.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11'  'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN

  host8b:
    build:
      context: ./host
      dockerfile: Dockerfile
    environment:
      - my_name=host8b
      - my_ip=172.18.8.11
      - gateway_ip=172.18.8.3
    networks:
      subnet_8:
        ipv4_address: 172.18.8.11
    depends_on:
      - router8
    command: ["sh", "-c", "sleep 10 && python host.py --test 'ping 172.18.8.3' 'ping 172.18.8.10' 'ping 172.18.7.11' 'ping 172.18.7.10' 'ping 172.18.5.10' 'ping 172.18.1.10' 'ping 172.18.1.11' 'ping 172.18.2.10' 'ping 172.18.2.11' 'ping 172.18.3.10' 'ping 172.18.3.11' 'ping 172.18.4.10' 'ping 172.18.4.11' 'ping 172.18.5.11' 'ping 172.18.6.10' 'ping 172.18.6.11'"]
    volumes:
      - ./logs:/app/logs
    cap_add:
      - NET_ADMIN








  













networks:
  subnet_1:
    driver: bridge
    ipam:
      config:
        - subnet: 172.18.1.0/24
  subnet_2:
    driver: bridge
    ipam:
      config:
        - subnet: 172.18.2.0/24
  subnet_3:
    driver: bridge
    ipam:
      config:
        - subnet: 172.18.3.0/24
  subnet_4:
    driver: bridge
    ipam:
      config:
        - subnet: 172.18.4.0/24
  subnet_5:
    driver: bridge
    ipam:
      config:
        - subnet: 172.18.5.0/24
  subnet_6:
    driver: bridge
    ipam:
      config:
        - subnet: 172.18.6.0/24
  subnet_7:
    driver: bridge
    ipam:
      config:
        - subnet: 172.18.7.0/24
  subnet_8:
    driver: bridge
    ipam:
      config:
        - subnet: 172.18.8.0/24

  